document.addEventListener('DOMContentLoaded',()=>{loadHistory();const clearBtn=document.getElementById('clear-history-btn');if(clearBtn){clearBtn.addEventListener('click',()=>{if(confirm('à¸„à¸¸à¸“à¸•à¹‰à¸­à¸‡à¸à¸²à¸£à¸¥à¹‰à¸²à¸‡à¸›à¸£à¸°à¸§à¸±à¸•à¸´à¸—à¸±à¹‰à¸‡à¸«à¸¡à¸”à¹ƒà¸Šà¹ˆà¸«à¸£à¸·à¸­à¹„à¸¡à¹ˆ?')){localStorage.removeItem('quizHistory');location.reload();}});}});function loadHistory(){const history=JSON.parse(localStorage.getItem('quizHistory')|| '[]');const historyList=document.getElementById('history-list');if(history.length===0){return;}historyList.innerHTML='';let totalScore=0;let totalQuestions=0;let totalDuration=0;history.forEach((attempt,index)=>{totalScore+=attempt.score;totalQuestions+=attempt.total;totalDuration+=attempt.duration;const percent=Math.round((attempt.score/attempt.total)*100);const color=getScoreColor(percent);const itemHTML=`<div class="history-item animate-in fade-in slide-in-from-bottom-4" style="animation-delay:${index*50}ms"><div class="item-circle-box"><svg viewBox="0 0 100 100" class="w-full h-full transform-rotate-90"><circle cx="50" cy="50" r="40" stroke="#f1f5f9" stroke-width="10" fill="transparent"/><circle cx="50" cy="50" r="40" stroke="${color}" stroke-width="10" fill="transparent" stroke-dasharray="251.3" stroke-dashoffset="${251.3-(251.3*percent/100)}" stroke-linecap="round"/></svg><div class="absolute inset-0 flex items-center justify-center"><span class="text-[10px] font-bold text-slate-700">${percent}%</span></div></div><div class="item-info"><div class="item-title">${attempt.score}/${attempt.total}à¸„à¸°à¹à¸™à¸™</div><div class="item-meta"><span>ğŸ•’ ${formatTime(attempt.duration)}</span><span>ğŸ“… ${attempt.date}</span></div></div><div class="item-score-badge">${percent}%</div></div>`;historyList.insertAdjacentHTML('beforeend',itemHTML);});const avgPercent=Math.round((totalScore/totalQuestions)*100)|| 0;const avgCircle=document.getElementById('avg-progress-circle');const avgPercentText=document.getElementById('avg-percent');const avgScoreSub=document.getElementById('avg-score-text');const totalCount=document.getElementById('total-quizzes');const avgTimeText=document.getElementById('avg-time');if(avgCircle){const offset=282.7-(282.7*avgPercent/100);avgCircle.style.strokeDashoffset=offset;avgCircle.style.stroke=getScoreColor(avgPercent);}if(avgPercentText)avgPercentText.innerText=`${avgPercent}%`;if(avgScoreSub)avgScoreSub.innerText=`${totalScore}/${totalQuestions}`;if(totalCount)totalCount.innerText=history.length;if(avgTimeText)avgTimeText.innerText=formatTime(Math.floor(totalDuration/history.length));}function getScoreColor(percent){if(percent>=80)return '#4CAF50';if(percent>=50)return '#FF9800';return '#F44336';}function formatTime(seconds){const mins=Math.floor(seconds/60);const secs=seconds % 60;return `${mins}:${secs.toString().padStart(2,'0')}`;}